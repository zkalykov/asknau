{"ast":null,"code":"var _jsxFileName = \"/Users/zhyrgalbekkalykov/Documents/ai_research/asknau/asknau/src/Chat.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\n// src/Chat.js\nimport React, { useState, useEffect, useRef, useCallback } from 'react';\nimport './Chat.css';\nimport { useNavigate, useLocation } from 'react-router-dom';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faUser } from '@fortawesome/free-regular-svg-icons';\nimport { faPlay, faRightFromBracket, faClockRotateLeft, faPlus } from '@fortawesome/free-solid-svg-icons';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction CopyButton({\n  text\n}) {\n  _s();\n  const [copied, setCopied] = useState(false);\n  const handleCopy = async () => {\n    try {\n      await navigator.clipboard.writeText(text);\n      setCopied(true);\n      setTimeout(() => setCopied(false), 1000);\n    } catch (error) {\n      alert('Failed to copy text.');\n      console.error('Copy failed:', error);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"button\", {\n    className: \"copy-button\",\n    \"aria-label\": copied ? 'Text copied' : 'Copy text',\n    \"data-tooltip\": copied ? 'Copied' : 'Copy',\n    onClick: handleCopy,\n    children: copied ? /*#__PURE__*/_jsxDEV(\"svg\", {\n      fill: \"currentColor\",\n      viewBox: \"0 0 20 20\",\n      children: /*#__PURE__*/_jsxDEV(\"path\", {\n        d: \"M16.707 5.293a1 1 0 00-1.414 0L7.5 13.086l-2.793-2.793a1 1 0 00-1.414 1.414l3.5 3.5a1 1 0 001.414 0l8-8a1 1 0 000-1.414z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 32,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 31,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"svg\", {\n      fill: \"currentColor\",\n      viewBox: \"0 0 20 20\",\n      children: [/*#__PURE__*/_jsxDEV(\"path\", {\n        d: \"M8 2a2 2 0 00-2 2v2h2V4h8v8h-2v2h2a2 2 0 002-2V4a2 2 0 00-2-2H8z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 36,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n        d: \"M2 8a2 2 0 012-2h8a2 2 0 012 2v8a2 2 0 01-2 2H4a2 2 0 01-2-2V8z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 37,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 35,\n      columnNumber: 9\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 24,\n    columnNumber: 5\n  }, this);\n}\n_s(CopyButton, \"NE86rL3vg4NVcTTWDavsT0hUBJs=\");\n_c = CopyButton;\nfunction Chat() {\n  _s2();\n  const navigate = useNavigate();\n  const location = useLocation();\n\n  // State variables\n  const [messages, setMessages] = useState([]);\n  const [inputValue, setInputValue] = useState('');\n  const [botTyping, setBotTyping] = useState(false);\n  const [userScrolled, setUserScrolled] = useState(false);\n  const [showGoDownButton, setShowGoDownButton] = useState(false);\n  const [profileMenuOpen, setProfileMenuOpen] = useState(false);\n  const [errorMessage, setErrorMessage] = useState('');\n  const [modalOpen, setModalOpen] = useState(false);\n  const [modalContent, setModalContent] = useState('');\n  const [userName, setUserName] = useState('');\n  const [userEmail, setUserEmail] = useState('');\n  const [chatHistory, setChatHistory] = useState([]);\n  const [chatId, setChatId] = useState(null);\n\n  // Refs\n  const lastScrollTop = useRef(0);\n  const chatBodyRef = useRef(null);\n  const profileMenuRef = useRef(null);\n\n  // Extract chat_id from URL\n  const queryParams = new URLSearchParams(location.search);\n  const urlChatId = queryParams.get('id');\n\n  // Scroll to bottom function\n  const scrollToBottom = useCallback(() => {\n    if (chatBodyRef.current) {\n      chatBodyRef.current.scrollTo({\n        top: chatBodyRef.current.scrollHeight,\n        behavior: 'smooth'\n      });\n      setUserScrolled(false);\n    }\n  }, []);\n\n  // Modal control functions\n  const openModal = content => {\n    setModalContent(content);\n    setModalOpen(true);\n  };\n  const closeModal = () => {\n    setModalOpen(false);\n    setModalContent('');\n  };\n\n  // Fetch user profile\n  const fetchUserProfile = useCallback(async token => {\n    try {\n      const response = await fetch('https://asknau-backend-20d79e207a54.herokuapp.com/profile', {\n        method: 'GET',\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      if (response.status === 401) {\n        localStorage.removeItem('token');\n        navigate('/login');\n        return;\n      }\n      if (!response.ok) throw new Error(`Server error: ${response.statusText}`);\n      const data = await response.json();\n      setUserName(data.full_name || 'User');\n      setUserEmail(data.email || 'No Email');\n      console.log('User profile fetched:', data);\n    } catch (error) {\n      console.error('Failed to fetch user profile:', error);\n      setErrorMessage('Failed to fetch user profile.');\n    }\n  }, [navigate]);\n\n  // Append message to state\n  const appendMessage = (content, isUser = true) => {\n    if (!content) {\n      console.warn('Attempted to append a message with no content.');\n      return;\n    }\n    setMessages(prev => [...prev, {\n      content,\n      isUser\n    }]);\n  };\n\n  // Type bot message effect\n  const typeBotMessage = fullContent => {\n    if (!fullContent || typeof fullContent !== 'string') {\n      console.error('Invalid bot message content:', fullContent);\n      appendMessage('Error: Invalid bot response.', false);\n      return;\n    }\n    setBotTyping(true);\n    const words = fullContent.split(' ');\n    let i = 0;\n    const speed = 50; // milliseconds per word\n\n    setMessages(prevMessages => [...prevMessages, {\n      content: '',\n      isUser: false\n    }]);\n    const typingInterval = setInterval(() => {\n      setMessages(prevMessages => {\n        const lastMessage = prevMessages[prevMessages.length - 1];\n        if (!lastMessage) {\n          console.error('Last message is undefined during typing.');\n          clearInterval(typingInterval);\n          setBotTyping(false);\n          return prevMessages;\n        }\n        const newContent = `${lastMessage.content} ${words[i]}`.trim();\n        return [...prevMessages.slice(0, -1), {\n          ...lastMessage,\n          content: newContent\n        }];\n      });\n      i++;\n      if (i >= words.length) {\n        clearInterval(typingInterval);\n        setBotTyping(false);\n      }\n    }, speed);\n  };\n\n  // Send message function\n  const sendMessage = async (message = null) => {\n    if (botTyping) return;\n    const msg = message || inputValue.trim();\n    if (!msg) return;\n    if (msg.length > 2000) {\n      setErrorMessage('Message cannot exceed 2000 characters.');\n      return;\n    }\n    setErrorMessage('');\n    appendMessage(msg, true);\n    if (!message) setInputValue('');\n    const token = localStorage.getItem('token');\n    if (!token) {\n      navigate('/login');\n      return;\n    }\n    try {\n      const response = await fetch('https://asknau-backend-20d79e207a54.herokuapp.com/ask', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: `Bearer ${token}`\n        },\n        body: JSON.stringify({\n          question: msg,\n          chat_id: chatId\n        })\n      });\n      if (response.status === 401) {\n        localStorage.removeItem('token');\n        navigate('/login');\n        return;\n      }\n      if (!response.ok) throw new Error(`Server error: ${response.statusText}`);\n      const data = await response.json();\n      console.log('Send message response:', data);\n      if (data.error) {\n        appendMessage(`Error: ${data.error}`, false);\n      } else {\n        if (!data.chat_id || !data.answer) {\n          appendMessage('Error: Incomplete response from server.', false);\n          console.error('Incomplete response:', data);\n          return;\n        }\n        setChatId(data.chat_id);\n        typeBotMessage(data.answer);\n      }\n    } catch (error) {\n      appendMessage(`Error: ${error.message}`, false);\n      console.error('Send message error:', error);\n    }\n  };\n\n  // Handle scroll in chat body\n  const handleChatBodyScroll = () => {\n    const chatBody = chatBodyRef.current;\n    if (!chatBody) return;\n    const currentScrollTop = chatBody.scrollTop;\n    const isAtBottom = Math.abs(chatBody.scrollHeight - chatBody.scrollTop - chatBody.clientHeight) < 1;\n    if (currentScrollTop > lastScrollTop.current && !isAtBottom) {\n      if (!userScrolled) setShowGoDownButton(true);\n    } else if (isAtBottom) {\n      setShowGoDownButton(false);\n      setUserScrolled(false);\n    } else {\n      setUserScrolled(true);\n      setShowGoDownButton(false);\n    }\n    lastScrollTop.current = currentScrollTop;\n  };\n\n  // Toggle profile menu\n  const toggleProfileMenu = () => {\n    setProfileMenuOpen(!profileMenuOpen);\n  };\n\n  // Fetch chat history\n  const fetchHistory = async token => {\n    try {\n      const response = await fetch('https://asknau-backend-20d79e207a54.herokuapp.com/history', {\n        method: 'GET',\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      if (!response.ok) {\n        console.error('Failed to fetch history');\n        setErrorMessage('Failed to fetch history.');\n        return;\n      }\n      const data = await response.json();\n      console.log('Fetched history:', data);\n      setChatHistory(data.history || []);\n    } catch (err) {\n      console.error('Error fetching history:', err);\n      setErrorMessage('Error fetching history.');\n    }\n  };\n\n  // Handle history button click\n  const handleHistoryClick = async e => {\n    e.preventDefault();\n    const token = localStorage.getItem('token');\n    if (!token) {\n      navigate('/login');\n      return;\n    }\n    await fetchHistory(token);\n    openModal('History');\n    setProfileMenuOpen(false);\n  };\n\n  // Handle new chat button click\n  const handleNewChatClick = e => {\n    e.preventDefault();\n    // Navigate to /chat without an id to start a new conversation\n    navigate('/chat');\n  };\n\n  // Load selected chat from history\n  const loadSelectedHistory = async selectedChatId => {\n    setModalOpen(false);\n    const token = localStorage.getItem('token');\n    if (!token) {\n      navigate('/login');\n      return;\n    }\n    // Navigate to the selected chat\n    navigate(`/chat?id=${selectedChatId}`);\n  };\n\n  // Load chat messages based on chat_id\n  const loadChatMessages = useCallback(async id => {\n    const token = localStorage.getItem('token');\n    if (!token) {\n      navigate('/login');\n      return;\n    }\n    try {\n      const response = await fetch(`https://asknau-backend-20d79e207a54.herokuapp.com/chats/${id}/messages`, {\n        method: 'GET',\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      if (response.status === 401) {\n        localStorage.removeItem('token');\n        navigate('/login');\n        return;\n      }\n      if (!response.ok) throw new Error(`Failed to fetch chat messages: ${response.statusText}`);\n      const data = await response.json();\n      console.log('Fetched chat messages:', data);\n      if (!data.messages || !Array.isArray(data.messages)) {\n        console.error('Invalid messages format:', data);\n        setErrorMessage('Invalid messages format received.');\n        return;\n      }\n      const loadedMessages = data.messages.map((m, index) => {\n        if (m.user_message && typeof m.user_message === 'string') {\n          return {\n            content: m.user_message,\n            isUser: true\n          };\n        } else if (m.bot_message && typeof m.bot_message === 'string') {\n          return {\n            content: m.bot_message,\n            isUser: false\n          };\n        }\n        console.warn(`Message at index ${index} is missing content:`, m);\n        return null;\n      }).filter(Boolean);\n      setChatId(id);\n      setMessages(loadedMessages);\n      scrollToBottom();\n    } catch (err) {\n      console.error('Error fetching chat messages:', err);\n      setErrorMessage('Failed to load chat messages.');\n    }\n  }, [navigate, scrollToBottom]);\n\n  // Send welcome message if no messages exist\n  const sendWelcomeMessage = useCallback(() => {\n    if (messages.length === 0) {\n      appendMessage('Hello! Welcome to AskNAU. How can I assist you today?', false);\n    }\n  }, [messages]);\n\n  // Handle profile menu outside click\n  useEffect(() => {\n    const handleClickOutside = event => {\n      if (profileMenuRef.current && !profileMenuRef.current.contains(event.target) && event.target.tagName !== 'IMG') {\n        setProfileMenuOpen(false);\n      }\n    };\n    if (profileMenuOpen) {\n      document.addEventListener('mousedown', handleClickOutside);\n    }\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, [profileMenuOpen]);\n\n  // Load user profile and chat messages on initial load and when urlChatId changes\n  useEffect(() => {\n    const token = localStorage.getItem('token');\n    if (!token) {\n      navigate('/login');\n    } else {\n      fetchUserProfile(token).then(() => {\n        if (urlChatId) {\n          console.log('Loading chat with ID:', urlChatId);\n          loadChatMessages(urlChatId);\n        } else {\n          // No chat id: start a new conversation\n          setChatId(null);\n          setMessages([]); // Clear previous messages if any\n          sendWelcomeMessage();\n        }\n      });\n    }\n  }, [navigate, fetchUserProfile, urlChatId, loadChatMessages, sendWelcomeMessage]);\n\n  // Scroll down when messages update if user hasn't scrolled away\n  useEffect(() => {\n    if (!userScrolled) scrollToBottom();\n  }, [messages, userScrolled, scrollToBottom]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"app-container text-gray-300 flex items-center justify-center h-full\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"w-full h-full flex flex-col max-w-4xl mx-auto bg-gray-900 rounded-lg shadow-lg\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"chat-header p-4 flex items-center justify-between bg-gray-800 rounded-t-lg\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-2xl font-bold text-white\",\n            children: \"AskNAU\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 406,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            style: {\n              color: 'rgba(6,147,227,1)'\n            },\n            className: \"text-sm font-normal ml-2\",\n            children: \"(North American University AI)\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 407,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 405,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"relative\",\n          children: [/*#__PURE__*/_jsxDEV(\"img\", {\n            src: \"https://cdn.pixabay.com/photo/2015/10/05/22/37/blank-profile-picture-973460_1280.png\",\n            alt: \"User profile\",\n            className: \"w-8 h-8 rounded-full cursor-pointer\",\n            onClick: toggleProfileMenu\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 412,\n            columnNumber: 13\n          }, this), profileMenuOpen && /*#__PURE__*/_jsxDEV(\"div\", {\n            id: \"profile-menu\",\n            ref: profileMenuRef,\n            className: \"absolute right-0 mt-2 w-48 rounded-md shadow-lg bg-gray-700 z-10\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"block px-4 py-2 text-left w-full text-white hover:bg-gray-600\",\n              onClick: e => {\n                e.preventDefault();\n                openModal('Profile');\n                setProfileMenuOpen(false);\n              },\n              children: [/*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n                icon: faUser,\n                className: \"mr-2\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 432,\n                columnNumber: 19\n              }, this), \"Profile\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 424,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"block px-4 py-2 text-left w-full text-white hover:bg-gray-600\",\n              onClick: handleNewChatClick,\n              children: [/*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n                icon: faPlus,\n                className: \"mr-2\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 439,\n                columnNumber: 19\n              }, this), \"New Chat\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 435,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"block px-4 py-2 text-left w-full text-white hover:bg-gray-600\",\n              onClick: handleHistoryClick,\n              children: [/*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n                icon: faClockRotateLeft,\n                className: \"mr-2\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 446,\n                columnNumber: 19\n              }, this), \"History\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 442,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"block px-4 py-2 text-left w-full text-white hover:bg-gray-600\",\n              onClick: e => {\n                e.preventDefault();\n                navigate('/demo');\n                setProfileMenuOpen(false);\n              },\n              children: [/*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n                icon: faPlay,\n                className: \"mr-2\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 457,\n                columnNumber: 19\n              }, this), \"Demo\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 449,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"block px-4 py-2 text-left w-full text-white hover:bg-gray-600\",\n              onClick: e => {\n                e.preventDefault();\n                localStorage.removeItem('token');\n                navigate('/login');\n                setProfileMenuOpen(false);\n              },\n              children: [/*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n                icon: faRightFromBracket,\n                className: \"mr-2\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 469,\n                columnNumber: 19\n              }, this), \"Logout\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 460,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 419,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 411,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 404,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"chat-body flex-1 p-4 space-y-4 overflow-y-auto bg-gray-700\",\n        ref: chatBodyRef,\n        onScroll: handleChatBodyScroll,\n        children: [messages.map((message, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `message ${message.isUser ? 'user-message' : 'bot-message'}`,\n          children: message.isUser ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"user-message-content bg-blue-600 text-white p-2 rounded-lg max-w-md\",\n            children: message.content\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 486,\n            columnNumber: 17\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"bot-message-content bg-gray-600 text-white p-2 rounded-lg flex items-start\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex-grow\",\n              children: message.content\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 491,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(CopyButton, {\n              text: message.content\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 492,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 490,\n            columnNumber: 17\n          }, this)\n        }, index, false, {\n          fileName: _jsxFileName,\n          lineNumber: 484,\n          columnNumber: 13\n        }, this)), botTyping && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"message bot-message\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"bot-message-content bg-gray-600 text-white p-2 rounded-lg flex items-center\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"typing-indicator flex space-x-1\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"dot w-2 h-2 bg-white rounded-full animate-bounce\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 501,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"dot w-2 h-2 bg-white rounded-full animate-bounce delay-200\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 502,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"dot w-2 h-2 bg-white rounded-full animate-bounce delay-400\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 503,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 500,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 499,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 498,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 478,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"chat-footer p-4 bg-gray-800 rounded-b-lg\",\n        children: [errorMessage && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"error-message text-red-500 text-sm mb-2\",\n          children: errorMessage\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 512,\n          columnNumber: 28\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"input-container flex items-center\",\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            value: inputValue,\n            onChange: e => {\n              if (e.target.value.length <= 2000) {\n                setInputValue(e.target.value);\n                setErrorMessage('');\n              } else {\n                setErrorMessage('Message cannot exceed 2000 characters.');\n              }\n            },\n            onKeyDown: e => {\n              if (e.key === 'Enter') {\n                e.preventDefault();\n                sendMessage();\n              }\n            },\n            placeholder: \"Message AskNAU...\",\n            autoComplete: \"off\",\n            className: \"flex-grow p-2 rounded-l-md bg-gray-600 text-white focus:outline-none\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 514,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: sendMessage,\n            className: \"p-2 bg-blue-600 rounded-r-md hover:bg-blue-700 focus:outline-none\",\n            \"aria-label\": \"Send Message\",\n            children: /*#__PURE__*/_jsxDEV(\"svg\", {\n              className: \"w-6 h-6 text-white\",\n              fill: \"none\",\n              stroke: \"currentColor\",\n              viewBox: \"0 0 24 24\",\n              children: /*#__PURE__*/_jsxDEV(\"path\", {\n                strokeLinecap: \"round\",\n                strokeLinejoin: \"round\",\n                strokeWidth: \"2\",\n                d: \"M9 5l7 7-7 7\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 541,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 540,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 535,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 513,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"disclaimer text-xs text-gray-400 mt-2\",\n          children: \"@ AskNAU - 2024\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 545,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 511,\n        columnNumber: 9\n      }, this), showGoDownButton && /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"go-down-button fixed bottom-20 right-5 p-2 bg-blue-600 rounded-full shadow-lg hover:bg-blue-700 focus:outline-none\",\n        onClick: scrollToBottom,\n        \"aria-label\": \"Go to bottom\",\n        children: /*#__PURE__*/_jsxDEV(\"svg\", {\n          fill: \"none\",\n          stroke: \"currentColor\",\n          className: \"w-6 h-6 text-white\",\n          viewBox: \"0 0 24 24\",\n          children: /*#__PURE__*/_jsxDEV(\"path\", {\n            strokeLinecap: \"round\",\n            strokeLinejoin: \"round\",\n            strokeWidth: \"2\",\n            d: \"M19 9l-7 7-7-7\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 556,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 555,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 550,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 402,\n      columnNumber: 7\n    }, this), modalOpen && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"modal-overlay fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-20\",\n      onClick: closeModal,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"modal-box bg-gray-800 p-6 rounded-md w-11/12 max-w-md relative\",\n        onClick: e => e.stopPropagation(),\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"modal-title font-bold text-xl mb-4 text-white\",\n          children: \"Chat\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 572,\n          columnNumber: 13\n        }, this), modalContent === 'Profile' && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-4 modal-content text-white\",\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"font-semibold\",\n              children: \"Name:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 576,\n              columnNumber: 19\n            }, this), \" \", userName]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 575,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"font-semibold\",\n              children: \"Email:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 579,\n              columnNumber: 19\n            }, this), \" \", userEmail]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 578,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"disclaimer\",\n            children: \"For profile questions, contact zkalykov@na.edu\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 581,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 574,\n          columnNumber: 15\n        }, this), modalContent === 'History' && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-4 modal-content text-white\",\n          children: chatHistory && chatHistory.length > 0 ? chatHistory.map((h, idx) => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"arkasy p-2 rounded cursor-pointer hover:bg-gray-700 flex justify-between items-center\",\n            onClick: () => loadSelectedHistory(h.chat_id),\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"font-semibold\",\n                children: h.history_title\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 594,\n                columnNumber: 25\n              }, this), h.title ? ` - ${h.title}` : '']\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 593,\n              columnNumber: 23\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-xs text-gray-400\",\n              children: h.date_created ? new Date(h.date_created).toLocaleString() : ''\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 597,\n              columnNumber: 23\n            }, this)]\n          }, idx, true, {\n            fileName: _jsxFileName,\n            lineNumber: 588,\n            columnNumber: 21\n          }, this)) : /*#__PURE__*/_jsxDEV(\"div\", {\n            children: \"No history found.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 603,\n            columnNumber: 19\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 585,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: closeModal,\n          className: \"modal-close-button mt-4 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 focus:outline-none\",\n          children: \"Close\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 607,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 568,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 564,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 401,\n    columnNumber: 5\n  }, this);\n}\n_s2(Chat, \"b3/HRP4wgkUthSt3hV/2016KKOA=\", false, function () {\n  return [useNavigate, useLocation];\n});\n_c2 = Chat;\nexport default Chat;\nvar _c, _c2;\n$RefreshReg$(_c, \"CopyButton\");\n$RefreshReg$(_c2, \"Chat\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useCallback","useNavigate","useLocation","FontAwesomeIcon","faUser","faPlay","faRightFromBracket","faClockRotateLeft","faPlus","jsxDEV","_jsxDEV","CopyButton","text","_s","copied","setCopied","handleCopy","navigator","clipboard","writeText","setTimeout","error","alert","console","className","onClick","children","fill","viewBox","d","fileName","_jsxFileName","lineNumber","columnNumber","_c","Chat","_s2","navigate","location","messages","setMessages","inputValue","setInputValue","botTyping","setBotTyping","userScrolled","setUserScrolled","showGoDownButton","setShowGoDownButton","profileMenuOpen","setProfileMenuOpen","errorMessage","setErrorMessage","modalOpen","setModalOpen","modalContent","setModalContent","userName","setUserName","userEmail","setUserEmail","chatHistory","setChatHistory","chatId","setChatId","lastScrollTop","chatBodyRef","profileMenuRef","queryParams","URLSearchParams","search","urlChatId","get","scrollToBottom","current","scrollTo","top","scrollHeight","behavior","openModal","content","closeModal","fetchUserProfile","token","response","fetch","method","headers","Authorization","status","localStorage","removeItem","ok","Error","statusText","data","json","full_name","email","log","appendMessage","isUser","warn","prev","typeBotMessage","fullContent","words","split","i","speed","prevMessages","typingInterval","setInterval","lastMessage","length","clearInterval","newContent","trim","slice","sendMessage","message","msg","getItem","body","JSON","stringify","question","chat_id","answer","handleChatBodyScroll","chatBody","currentScrollTop","scrollTop","isAtBottom","Math","abs","clientHeight","toggleProfileMenu","fetchHistory","history","err","handleHistoryClick","e","preventDefault","handleNewChatClick","loadSelectedHistory","selectedChatId","loadChatMessages","id","Array","isArray","loadedMessages","map","m","index","user_message","bot_message","filter","Boolean","sendWelcomeMessage","handleClickOutside","event","contains","target","tagName","document","addEventListener","removeEventListener","then","style","color","src","alt","ref","icon","onScroll","type","value","onChange","onKeyDown","key","placeholder","autoComplete","stroke","strokeLinecap","strokeLinejoin","strokeWidth","stopPropagation","h","idx","history_title","title","date_created","Date","toLocaleString","_c2","$RefreshReg$"],"sources":["/Users/zhyrgalbekkalykov/Documents/ai_research/asknau/asknau/src/Chat.js"],"sourcesContent":["// src/Chat.js\nimport React, { useState, useEffect, useRef, useCallback } from 'react';\nimport './Chat.css';\nimport { useNavigate, useLocation } from 'react-router-dom';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faUser } from '@fortawesome/free-regular-svg-icons';\nimport { faPlay, faRightFromBracket, faClockRotateLeft, faPlus } from '@fortawesome/free-solid-svg-icons';\n\nfunction CopyButton({ text }) {\n  const [copied, setCopied] = useState(false);\n\n  const handleCopy = async () => {\n    try {\n      await navigator.clipboard.writeText(text);\n      setCopied(true);\n      setTimeout(() => setCopied(false), 1000);\n    } catch (error) {\n      alert('Failed to copy text.');\n      console.error('Copy failed:', error);\n    }\n  };\n\n  return (\n    <button\n      className=\"copy-button\"\n      aria-label={copied ? 'Text copied' : 'Copy text'}\n      data-tooltip={copied ? 'Copied' : 'Copy'}\n      onClick={handleCopy}\n    >\n      {copied ? (\n        <svg fill=\"currentColor\" viewBox=\"0 0 20 20\">\n          <path d=\"M16.707 5.293a1 1 0 00-1.414 0L7.5 13.086l-2.793-2.793a1 1 0 00-1.414 1.414l3.5 3.5a1 1 0 001.414 0l8-8a1 1 0 000-1.414z\"></path>\n        </svg>\n      ) : (\n        <svg fill=\"currentColor\" viewBox=\"0 0 20 20\">\n          <path d=\"M8 2a2 2 0 00-2 2v2h2V4h8v8h-2v2h2a2 2 0 002-2V4a2 2 0 00-2-2H8z\"></path>\n          <path d=\"M2 8a2 2 0 012-2h8a2 2 0 012 2v8a2 2 0 01-2 2H4a2 2 0 01-2-2V8z\"></path>\n        </svg>\n      )}\n    </button>\n  );\n}\n\nfunction Chat() {\n  const navigate = useNavigate();\n  const location = useLocation();\n\n  // State variables\n  const [messages, setMessages] = useState([]);\n  const [inputValue, setInputValue] = useState('');\n  const [botTyping, setBotTyping] = useState(false);\n  const [userScrolled, setUserScrolled] = useState(false);\n  const [showGoDownButton, setShowGoDownButton] = useState(false);\n  const [profileMenuOpen, setProfileMenuOpen] = useState(false);\n  const [errorMessage, setErrorMessage] = useState('');\n  const [modalOpen, setModalOpen] = useState(false);\n  const [modalContent, setModalContent] = useState('');\n  const [userName, setUserName] = useState('');\n  const [userEmail, setUserEmail] = useState('');\n  const [chatHistory, setChatHistory] = useState([]);\n  const [chatId, setChatId] = useState(null);\n\n  // Refs\n  const lastScrollTop = useRef(0);\n  const chatBodyRef = useRef(null);\n  const profileMenuRef = useRef(null);\n\n  // Extract chat_id from URL\n  const queryParams = new URLSearchParams(location.search);\n  const urlChatId = queryParams.get('id');\n\n  // Scroll to bottom function\n  const scrollToBottom = useCallback(() => {\n    if (chatBodyRef.current) {\n      chatBodyRef.current.scrollTo({\n        top: chatBodyRef.current.scrollHeight,\n        behavior: 'smooth',\n      });\n      setUserScrolled(false);\n    }\n  }, []);\n\n  // Modal control functions\n  const openModal = (content) => {\n    setModalContent(content);\n    setModalOpen(true);\n  };\n\n  const closeModal = () => {\n    setModalOpen(false);\n    setModalContent('');\n  };\n\n  // Fetch user profile\n  const fetchUserProfile = useCallback(async (token) => {\n    try {\n      const response = await fetch('https://asknau-backend-20d79e207a54.herokuapp.com/profile', {\n        method: 'GET',\n        headers: { Authorization: `Bearer ${token}` },\n      });\n      if (response.status === 401) {\n        localStorage.removeItem('token');\n        navigate('/login');\n        return;\n      }\n      if (!response.ok) throw new Error(`Server error: ${response.statusText}`);\n      const data = await response.json();\n      setUserName(data.full_name || 'User');\n      setUserEmail(data.email || 'No Email');\n      console.log('User profile fetched:', data);\n    } catch (error) {\n      console.error('Failed to fetch user profile:', error);\n      setErrorMessage('Failed to fetch user profile.');\n    }\n  }, [navigate]);\n\n  // Append message to state\n  const appendMessage = (content, isUser = true) => {\n    if (!content) {\n      console.warn('Attempted to append a message with no content.');\n      return;\n    }\n    setMessages((prev) => [...prev, { content, isUser }]);\n  };\n\n  // Type bot message effect\n  const typeBotMessage = (fullContent) => {\n    if (!fullContent || typeof fullContent !== 'string') {\n      console.error('Invalid bot message content:', fullContent);\n      appendMessage('Error: Invalid bot response.', false);\n      return;\n    }\n\n    setBotTyping(true);\n    const words = fullContent.split(' ');\n    let i = 0;\n    const speed = 50; // milliseconds per word\n\n    setMessages((prevMessages) => [...prevMessages, { content: '', isUser: false }]);\n\n    const typingInterval = setInterval(() => {\n      setMessages((prevMessages) => {\n        const lastMessage = prevMessages[prevMessages.length - 1];\n        if (!lastMessage) {\n          console.error('Last message is undefined during typing.');\n          clearInterval(typingInterval);\n          setBotTyping(false);\n          return prevMessages;\n        }\n        const newContent = `${lastMessage.content} ${words[i]}`.trim();\n        return [\n          ...prevMessages.slice(0, -1),\n          { ...lastMessage, content: newContent },\n        ];\n      });\n      i++;\n      if (i >= words.length) {\n        clearInterval(typingInterval);\n        setBotTyping(false);\n      }\n    }, speed);\n  };\n\n  // Send message function\n  const sendMessage = async (message = null) => {\n    if (botTyping) return;\n    const msg = message || inputValue.trim();\n    if (!msg) return;\n    if (msg.length > 2000) {\n      setErrorMessage('Message cannot exceed 2000 characters.');\n      return;\n    }\n    setErrorMessage('');\n    appendMessage(msg, true);\n    if (!message) setInputValue('');\n\n    const token = localStorage.getItem('token');\n    if (!token) {\n      navigate('/login');\n      return;\n    }\n\n    try {\n      const response = await fetch('https://asknau-backend-20d79e207a54.herokuapp.com/ask', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: `Bearer ${token}`,\n        },\n        body: JSON.stringify({ question: msg, chat_id: chatId }),\n      });\n\n      if (response.status === 401) {\n        localStorage.removeItem('token');\n        navigate('/login');\n        return;\n      }\n\n      if (!response.ok) throw new Error(`Server error: ${response.statusText}`);\n\n      const data = await response.json();\n      console.log('Send message response:', data);\n      if (data.error) {\n        appendMessage(`Error: ${data.error}`, false);\n      } else {\n        if (!data.chat_id || !data.answer) {\n          appendMessage('Error: Incomplete response from server.', false);\n          console.error('Incomplete response:', data);\n          return;\n        }\n        setChatId(data.chat_id);\n        typeBotMessage(data.answer);\n      }\n    } catch (error) {\n      appendMessage(`Error: ${error.message}`, false);\n      console.error('Send message error:', error);\n    }\n  };\n\n  // Handle scroll in chat body\n  const handleChatBodyScroll = () => {\n    const chatBody = chatBodyRef.current;\n    if (!chatBody) return;\n\n    const currentScrollTop = chatBody.scrollTop;\n    const isAtBottom = Math.abs(chatBody.scrollHeight - chatBody.scrollTop - chatBody.clientHeight) < 1;\n\n    if (currentScrollTop > lastScrollTop.current && !isAtBottom) {\n      if (!userScrolled) setShowGoDownButton(true);\n    } else if (isAtBottom) {\n      setShowGoDownButton(false);\n      setUserScrolled(false);\n    } else {\n      setUserScrolled(true);\n      setShowGoDownButton(false);\n    }\n    lastScrollTop.current = currentScrollTop;\n  };\n\n  // Toggle profile menu\n  const toggleProfileMenu = () => {\n    setProfileMenuOpen(!profileMenuOpen);\n  };\n\n  // Fetch chat history\n  const fetchHistory = async (token) => {\n    try {\n      const response = await fetch('https://asknau-backend-20d79e207a54.herokuapp.com/history', {\n        method: 'GET',\n        headers: { Authorization: `Bearer ${token}` },\n      });\n      if (!response.ok) {\n        console.error('Failed to fetch history');\n        setErrorMessage('Failed to fetch history.');\n        return;\n      }\n      const data = await response.json();\n      console.log('Fetched history:', data);\n      setChatHistory(data.history || []);\n    } catch (err) {\n      console.error('Error fetching history:', err);\n      setErrorMessage('Error fetching history.');\n    }\n  };\n\n  // Handle history button click\n  const handleHistoryClick = async (e) => {\n    e.preventDefault();\n    const token = localStorage.getItem('token');\n    if (!token) {\n      navigate('/login');\n      return;\n    }\n    await fetchHistory(token);\n    openModal('History');\n    setProfileMenuOpen(false);\n  };\n\n  // Handle new chat button click\n  const handleNewChatClick = (e) => {\n    e.preventDefault();\n    // Navigate to /chat without an id to start a new conversation\n    navigate('/chat');\n  };\n\n  // Load selected chat from history\n  const loadSelectedHistory = async (selectedChatId) => {\n    setModalOpen(false);\n    const token = localStorage.getItem('token');\n    if (!token) {\n      navigate('/login');\n      return;\n    }\n    // Navigate to the selected chat\n    navigate(`/chat?id=${selectedChatId}`);\n  };\n\n  // Load chat messages based on chat_id\n  const loadChatMessages = useCallback(async (id) => {\n    const token = localStorage.getItem('token');\n    if (!token) {\n      navigate('/login');\n      return;\n    }\n\n    try {\n      const response = await fetch(`https://asknau-backend-20d79e207a54.herokuapp.com/chats/${id}/messages`, {\n        method: 'GET',\n        headers: { Authorization: `Bearer ${token}` },\n      });\n\n      if (response.status === 401) {\n        localStorage.removeItem('token');\n        navigate('/login');\n        return;\n      }\n\n      if (!response.ok) throw new Error(`Failed to fetch chat messages: ${response.statusText}`);\n\n      const data = await response.json();\n      console.log('Fetched chat messages:', data);\n      if (!data.messages || !Array.isArray(data.messages)) {\n        console.error('Invalid messages format:', data);\n        setErrorMessage('Invalid messages format received.');\n        return;\n      }\n\n      const loadedMessages = data.messages.map((m, index) => {\n        if (m.user_message && typeof m.user_message === 'string') {\n          return { content: m.user_message, isUser: true };\n        } else if (m.bot_message && typeof m.bot_message === 'string') {\n          return { content: m.bot_message, isUser: false };\n        }\n        console.warn(`Message at index ${index} is missing content:`, m);\n        return null;\n      }).filter(Boolean);\n\n      setChatId(id);\n      setMessages(loadedMessages);\n      scrollToBottom();\n    } catch (err) {\n      console.error('Error fetching chat messages:', err);\n      setErrorMessage('Failed to load chat messages.');\n    }\n  }, [navigate, scrollToBottom]);\n\n  // Send welcome message if no messages exist\n  const sendWelcomeMessage = useCallback(() => {\n    if (messages.length === 0) {\n      appendMessage('Hello! Welcome to AskNAU. How can I assist you today?', false);\n    }\n  }, [messages]);\n\n  // Handle profile menu outside click\n  useEffect(() => {\n    const handleClickOutside = (event) => {\n      if (\n        profileMenuRef.current &&\n        !profileMenuRef.current.contains(event.target) &&\n        event.target.tagName !== 'IMG'\n      ) {\n        setProfileMenuOpen(false);\n      }\n    };\n\n    if (profileMenuOpen) {\n      document.addEventListener('mousedown', handleClickOutside);\n    }\n\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, [profileMenuOpen]);\n\n  // Load user profile and chat messages on initial load and when urlChatId changes\n  useEffect(() => {\n    const token = localStorage.getItem('token');\n    if (!token) {\n      navigate('/login');\n    } else {\n      fetchUserProfile(token).then(() => {\n        if (urlChatId) {\n          console.log('Loading chat with ID:', urlChatId);\n          loadChatMessages(urlChatId);\n        } else {\n          // No chat id: start a new conversation\n          setChatId(null);\n          setMessages([]); // Clear previous messages if any\n          sendWelcomeMessage();\n        }\n      });\n    }\n  }, [navigate, fetchUserProfile, urlChatId, loadChatMessages, sendWelcomeMessage]);\n\n  // Scroll down when messages update if user hasn't scrolled away\n  useEffect(() => {\n    if (!userScrolled) scrollToBottom();\n  }, [messages, userScrolled, scrollToBottom]);\n\n  return (\n    <div className=\"app-container text-gray-300 flex items-center justify-center h-full\">\n      <div className=\"w-full h-full flex flex-col max-w-4xl mx-auto bg-gray-900 rounded-lg shadow-lg\">\n        {/* Chat Header */}\n        <div className=\"chat-header p-4 flex items-center justify-between bg-gray-800 rounded-t-lg\">\n          <div className=\"flex items-center\">\n            <span className=\"text-2xl font-bold text-white\">AskNAU</span>\n            <span style={{ color: 'rgba(6,147,227,1)' }} className=\"text-sm font-normal ml-2\">\n              (North American University AI)\n            </span>\n          </div>\n          <div className=\"relative\">\n            <img\n              src=\"https://cdn.pixabay.com/photo/2015/10/05/22/37/blank-profile-picture-973460_1280.png\"\n              alt=\"User profile\"\n              className=\"w-8 h-8 rounded-full cursor-pointer\"\n              onClick={toggleProfileMenu}\n            />\n            {profileMenuOpen && (\n              <div\n                id=\"profile-menu\"\n                ref={profileMenuRef}\n                className=\"absolute right-0 mt-2 w-48 rounded-md shadow-lg bg-gray-700 z-10\"\n              >\n                <button\n                  className=\"block px-4 py-2 text-left w-full text-white hover:bg-gray-600\"\n                  onClick={(e) => {\n                    e.preventDefault();\n                    openModal('Profile');\n                    setProfileMenuOpen(false);\n                  }}\n                >\n                  <FontAwesomeIcon icon={faUser} className=\"mr-2\" />\n                  Profile\n                </button>\n                <button\n                  className=\"block px-4 py-2 text-left w-full text-white hover:bg-gray-600\"\n                  onClick={handleNewChatClick}\n                >\n                  <FontAwesomeIcon icon={faPlus} className=\"mr-2\" />\n                  New Chat\n                </button>\n                <button\n                  className=\"block px-4 py-2 text-left w-full text-white hover:bg-gray-600\"\n                  onClick={handleHistoryClick}\n                >\n                  <FontAwesomeIcon icon={faClockRotateLeft} className=\"mr-2\" />\n                  History\n                </button>\n                <button\n                  className=\"block px-4 py-2 text-left w-full text-white hover:bg-gray-600\"\n                  onClick={(e) => {\n                    e.preventDefault();\n                    navigate('/demo');\n                    setProfileMenuOpen(false);\n                  }}\n                >\n                  <FontAwesomeIcon icon={faPlay} className=\"mr-2\" />\n                  Demo\n                </button>\n                <button\n                  className=\"block px-4 py-2 text-left w-full text-white hover:bg-gray-600\"\n                  onClick={(e) => {\n                    e.preventDefault();\n                    localStorage.removeItem('token');\n                    navigate('/login');\n                    setProfileMenuOpen(false);\n                  }}\n                >\n                  <FontAwesomeIcon icon={faRightFromBracket} className=\"mr-2\" />\n                  Logout\n                </button>\n              </div>\n            )}\n          </div>\n        </div>\n\n        {/* Chat Body */}\n        <div\n          className=\"chat-body flex-1 p-4 space-y-4 overflow-y-auto bg-gray-700\"\n          ref={chatBodyRef}\n          onScroll={handleChatBodyScroll}\n        >\n          {messages.map((message, index) => (\n            <div key={index} className={`message ${message.isUser ? 'user-message' : 'bot-message'}`}>\n              {message.isUser ? (\n                <div className=\"user-message-content bg-blue-600 text-white p-2 rounded-lg max-w-md\">\n                  {message.content}\n                </div>\n              ) : (\n                <div className=\"bot-message-content bg-gray-600 text-white p-2 rounded-lg flex items-start\">\n                  <div className=\"flex-grow\">{message.content}</div>\n                  <CopyButton text={message.content} />\n                </div>\n              )}\n            </div>\n          ))}\n          {botTyping && (\n            <div className=\"message bot-message\">\n              <div className=\"bot-message-content bg-gray-600 text-white p-2 rounded-lg flex items-center\">\n                <div className=\"typing-indicator flex space-x-1\">\n                  <span className=\"dot w-2 h-2 bg-white rounded-full animate-bounce\"></span>\n                  <span className=\"dot w-2 h-2 bg-white rounded-full animate-bounce delay-200\"></span>\n                  <span className=\"dot w-2 h-2 bg-white rounded-full animate-bounce delay-400\"></span>\n                </div>\n              </div>\n            </div>\n          )}\n        </div>\n\n        {/* Chat Footer */}\n        <div className=\"chat-footer p-4 bg-gray-800 rounded-b-lg\">\n          {errorMessage && <div className=\"error-message text-red-500 text-sm mb-2\">{errorMessage}</div>}\n          <div className=\"input-container flex items-center\">\n            <input\n              type=\"text\"\n              value={inputValue}\n              onChange={(e) => {\n                if (e.target.value.length <= 2000) {\n                  setInputValue(e.target.value);\n                  setErrorMessage('');\n                } else {\n                  setErrorMessage('Message cannot exceed 2000 characters.');\n                }\n              }}\n              onKeyDown={(e) => {\n                if (e.key === 'Enter') {\n                  e.preventDefault();\n                  sendMessage();\n                }\n              }}\n              placeholder=\"Message AskNAU...\"\n              autoComplete=\"off\"\n              className=\"flex-grow p-2 rounded-l-md bg-gray-600 text-white focus:outline-none\"\n            />\n            <button\n              onClick={sendMessage}\n              className=\"p-2 bg-blue-600 rounded-r-md hover:bg-blue-700 focus:outline-none\"\n              aria-label=\"Send Message\"\n            >\n              <svg className=\"w-6 h-6 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M9 5l7 7-7 7\"></path>\n              </svg>\n            </button>\n          </div>\n          <div className=\"disclaimer text-xs text-gray-400 mt-2\">@ AskNAU - 2024</div>\n        </div>\n\n        {/* Go Down Button */}\n        {showGoDownButton && (\n          <button\n            className=\"go-down-button fixed bottom-20 right-5 p-2 bg-blue-600 rounded-full shadow-lg hover:bg-blue-700 focus:outline-none\"\n            onClick={scrollToBottom}\n            aria-label=\"Go to bottom\"\n          >\n            <svg fill=\"none\" stroke=\"currentColor\" className=\"w-6 h-6 text-white\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M19 9l-7 7-7-7\"></path>\n            </svg>\n          </button>\n        )}\n      </div>\n\n      {/* Modal Overlay */}\n      {modalOpen && (\n        <div\n          className=\"modal-overlay fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-20\"\n          onClick={closeModal}\n        >\n          <div\n            className=\"modal-box bg-gray-800 p-6 rounded-md w-11/12 max-w-md relative\"\n            onClick={(e) => e.stopPropagation()}\n          >\n            <h2 className=\"modal-title font-bold text-xl mb-4 text-white\">Chat</h2>\n            {modalContent === 'Profile' && (\n              <div className=\"space-y-4 modal-content text-white\">\n                <p>\n                  <span className=\"font-semibold\">Name:</span> {userName}\n                </p>\n                <p>\n                  <span className=\"font-semibold\">Email:</span> {userEmail}\n                </p>\n                <div className=\"disclaimer\">For profile questions, contact zkalykov@na.edu</div>\n              </div>\n            )}\n            {modalContent === 'History' && (\n              <div className=\"space-y-4 modal-content text-white\">\n                {chatHistory && chatHistory.length > 0 ? (\n                  chatHistory.map((h, idx) => (\n                    <div\n                      key={idx}\n                      className=\"arkasy p-2 rounded cursor-pointer hover:bg-gray-700 flex justify-between items-center\"\n                      onClick={() => loadSelectedHistory(h.chat_id)}\n                    >\n                      <div>\n                        <span className=\"font-semibold\">{h.history_title}</span>\n                        {h.title ? ` - ${h.title}` : ''}\n                      </div>\n                      <div className=\"text-xs text-gray-400\">\n                        {h.date_created ? new Date(h.date_created).toLocaleString() : ''}\n                      </div>\n                    </div>\n                  ))\n                ) : (\n                  <div>No history found.</div>\n                )}\n              </div>\n            )}\n            <button\n              onClick={closeModal}\n              className=\"modal-close-button mt-4 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 focus:outline-none\"\n            >\n              Close\n            </button>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default Chat;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}